services:
  reserve_port:
    type: "action"
    command: "python reserve_ports.py 4 ports.config"

  program1:
    type: "action"
    command: "./program1.sh"
    state:
      log:
        ready: "program is ready"
        complete: "program is completed"
      file:
        path: "program1-out.log"
        states:
          output_generated: "Generated output"
    dependency:
      items:
        program3: "ready"

  program2:
    type: "service"
    group: 'A'
    command: "./program2.sh"
    state:
      log:
        ready: "program is ready"
        complete: "program is completed"
    dependency:
      mode: "all"
      items:
        reserve_port: "final"
        program3: "ready"

  program3:
    type: "service"
    group: 'group-1'
    command: "./program3.sh"
    state:
      log:
        ready: "program is ready"
        complete: "program is completed"
    dependency:
      items:
        reserve_port: "final"

output:
  state_times: "state_times.json"
  max_concurrent_for_group:
    group-1:
      max: 1
      required_state: 'ready'

stop_signal: "/tmp/bashapp/stop"
max_run_time: 120
